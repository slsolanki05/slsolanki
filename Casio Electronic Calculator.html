<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Casio Electronic Calculator</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
        }

        body {
            background: linear-gradient(135deg, #2c3e50, #4a6491);
            display: flex;
            justify-content: center;
            align-items: center;
            min-height: 100vh;
            padding: 20px;
        }

        .calculator-container {
            max-width: 400px;
            width: 100%;
        }

        .calculator {
            background: linear-gradient(to bottom, #c0c0c0, #a0a0a0);
            border-radius: 15px;
            padding: 25px 20px 20px;
            box-shadow: 
                0 10px 30px rgba(0, 0, 0, 0.4),
                inset 0 1px 0 rgba(255, 255, 255, 0.3);
            border: 1px solid #808080;
            position: relative;
        }

        .casio-brand {
            text-align: center;
            margin-bottom: 15px;
        }

        .casio-brand h1 {
            font-family: 'Arial Black', sans-serif;
            font-size: 1.8rem;
            color: #2c3e50;
            text-shadow: 1px 1px 1px rgba(255, 255, 255, 0.5);
            letter-spacing: 1px;
        }

        .casio-brand .model {
            font-size: 0.9rem;
            color: #444;
            margin-top: 2px;
            font-weight: bold;
        }

        .display {
            background: linear-gradient(to bottom, #8a9b6e, #6e7b5a);
            border: 2px solid #2c3e50;
            border-radius: 8px;
            padding: 15px 20px;
            margin-bottom: 20px;
            box-shadow: inset 0 2px 5px rgba(0, 0, 0, 0.3);
            position: relative;
            overflow: hidden;
        }

        .display::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            height: 50%;
            background: linear-gradient(to bottom, rgba(255, 255, 255, 0.1), transparent);
            pointer-events: none;
        }

        .display-text {
            font-family: 'Courier New', monospace;
            font-size: 2.2rem;
            color: #1a1a1a;
            text-align: right;
            min-height: 50px;
            line-height: 1;
            overflow: hidden;
            text-overflow: ellipsis;
            letter-spacing: 1px;
        }

        .display-indicators {
            display: flex;
            justify-content: space-between;
            margin-top: 5px;
            font-size: 0.8rem;
            color: #2c3e50;
            font-weight: bold;
        }

        .buttons-grid {
            display: grid;
            grid-template-columns: repeat(5, 1fr);
            gap: 12px;
        }

        .button {
            background: linear-gradient(to bottom, #f0f0f0, #d0d0d0);
            border: 1px solid #808080;
            border-radius: 8px;
            padding: 15px 5px;
            font-size: 1.2rem;
            font-weight: bold;
            color: #333;
            cursor: pointer;
            display: flex;
            justify-content: center;
            align-items: center;
            box-shadow: 
                0 3px 5px rgba(0, 0, 0, 0.2),
                inset 0 1px 0 rgba(255, 255, 255, 0.8);
            transition: all 0.1s;
            user-select: none;
            position: relative;
            overflow: hidden;
        }

        .button::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            height: 50%;
            background: linear-gradient(to bottom, rgba(255, 255, 255, 0.3), transparent);
            border-radius: 8px 8px 0 0;
        }

        .button:active {
            transform: translateY(2px);
            box-shadow: 
                0 1px 2px rgba(0, 0, 0, 0.2),
                inset 0 1px 0 rgba(255, 255, 255, 0.5);
            background: linear-gradient(to bottom, #d0d0d0, #b0b0b0);
        }

        .button.function {
            background: linear-gradient(to bottom, #e0b080, #c09060);
            color: #fff;
            text-shadow: 1px 1px 1px rgba(0, 0, 0, 0.3);
        }

        .button.operator {
            background: linear-gradient(to bottom, #80a0e0, #6080c0);
            color: #fff;
            text-shadow: 1px 1px 1px rgba(0, 0, 0, 0.3);
        }

        .button.equals {
            background: linear-gradient(to bottom, #f0a050, #d08030);
            color: #fff;
            text-shadow: 1px 1px 1px rgba(0, 0, 0, 0.3);
        }

        .button.memory {
            background: linear-gradient(to bottom, #a0c0a0, #80a080);
            color: #fff;
            text-shadow: 1px 1px 1px rgba(0, 0, 0, 0.3);
        }

        .button.double-width {
            grid-column: span 2;
        }

        .button-label {
            position: relative;
            z-index: 1;
        }

        .button-small {
            font-size: 0.9rem;
        }

        .solar-panel {
            width: 120px;
            height: 25px;
            background: linear-gradient(135deg, #3a6ea5, #1e3a5f, #0d1b2a);
            margin: 0 auto 15px;
            border-radius: 3px;
            box-shadow: inset 0 0 5px rgba(0, 0, 0, 0.5);
            position: relative;
            overflow: hidden;
        }

        .solar-panel::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: 
                repeating-linear-gradient(
                    90deg,
                    transparent,
                    transparent 9px,
                    rgba(255, 255, 255, 0.1) 9px,
                    rgba(255, 255, 255, 0.1) 10px
                ),
                repeating-linear-gradient(
                    0deg,
                    transparent,
                    transparent 9px,
                    rgba(255, 255, 255, 0.1) 9px,
                    rgba(255, 255, 255, 0.1) 10px
                );
        }

        .calculator-footer {
            text-align: center;
            margin-top: 15px;
            font-size: 0.7rem;
            color: #555;
            font-weight: bold;
        }

        @media (max-width: 480px) {
            .calculator {
                padding: 20px 15px 15px;
            }
            
            .display-text {
                font-size: 1.8rem;
            }
            
            .button {
                padding: 12px 5px;
                font-size: 1.1rem;
            }
        }
    </style>
</head>
<body>
    <div class="calculator-container">
        <div class="calculator">
            <div class="solar-panel"></div>
            
            <div class="casio-brand">
                <h1>CASIO</h1>
                <div class="model">fx-991EX</div>
            </div>
            
            <div class="display">
                <div class="display-text" id="display">0</div>
                <div class="display-indicators">
                    <span id="modeIndicator">COMP</span>
                    <span id="memoryIndicator">M</span>
                    <span id="errorIndicator"></span>
                </div>
            </div>
            
            <div class="buttons-grid">
                <!-- Row 1 -->
                <div class="button function" data-action="shift">SHIFT</div>
                <div class="button function" data-action="alpha">ALPHA</div>
                <div class="button function" data-action="mode">MODE</div>
                <div class="button function" data-action="clear">ON/AC</div>
                <div class="button function" data-action="backspace">⌫</div>
                
                <!-- Row 2 -->
                <div class="button function" data-action="sqrt">√</div>
                <div class="button function" data-action="square">x²</div>
                <div class="button function" data-action="log">log</div>
                <div class="button function" data-action="ln">ln</div>
                <div class="button function" data-action="percent">%</div>
                
                <!-- Row 3 -->
                <div class="button memory" data-action="mc">MC</div>
                <div class="button memory" data-action="mr">MR</div>
                <div class="button memory" data-action="m-minus">M-</div>
                <div class="button memory" data-action="m-plus">M+</div>
                <div class="button operator" data-action="divide">÷</div>
                
                <!-- Row 4 -->
                <div class="button" data-number="7">7</div>
                <div class="button" data-number="8">8</div>
                <div class="button" data-number="9">9</div>
                <div class="button operator" data-action="multiply">×</div>
                <div class="button function" data-action="reciprocal">¹/x</div>
                
                <!-- Row 5 -->
                <div class="button" data-number="4">4</div>
                <div class="button" data-number="5">5</div>
                <div class="button" data-number="6">6</div>
                <div class="button operator" data-action="subtract">−</div>
                <div class="button function" data-action="factorial">x!</div>
                
                <!-- Row 6 -->
                <div class="button" data-number="1">1</div>
                <div class="button" data-number="2">2</div>
                <div class="button" data-number="3">3</div>
                <div class="button operator" data-action="add">+</div>
                <div class="button function" data-action="pi">π</div>
                
                <!-- Row 7 -->
                <div class="button function" data-action="plus-minus">±</div>
                <div class="button" data-number="0">0</div>
                <div class="button" data-action="decimal">.</div>
                <div class="button equals" data-action="equals">=</div>
                <div class="button function" data-action="exponent">EXP</div>
            </div>
            
            <div class="calculator-footer">
                TWO WAY POWER · LCD
            </div>
        </div>
    </div>

    <script>
        // Calculator state
        const calculator = {
            displayValue: '0',
            firstOperand: null,
            waitingForSecondOperand: false,
            operator: null,
            memory: 0,
            shiftMode: false,
            lastAction: null
        };

        // DOM elements
        const display = document.getElementById('display');
        const memoryIndicator = document.getElementById('memoryIndicator');
        const errorIndicator = document.getElementById('errorIndicator');

        // Update display
        function updateDisplay() {
            const value = calculator.displayValue;
            // Format display for better readability
            if (value.length > 12) {
                // Use exponential notation for very large/small numbers
                const num = parseFloat(value);
                if (Math.abs(num) > 999999999999 || (Math.abs(num) < 0.0000000001 && num !== 0)) {
                    display.textContent = num.toExponential(6);
                } else {
                    // Truncate if still too long
                    display.textContent = value.substring(0, 12);
                }
            } else {
                display.textContent = value;
            }
            
            // Update memory indicator
            memoryIndicator.style.visibility = calculator.memory !== 0 ? 'visible' : 'hidden';
            
            // Clear error after a delay
            if (calculator.lastAction === 'error') {
                setTimeout(() => {
                    errorIndicator.textContent = '';
                    calculator.lastAction = null;
                }, 2000);
            }
        }

        // Input digit
        function inputDigit(digit) {
            const { displayValue, waitingForSecondOperand } = calculator;
            
            if (waitingForSecondOperand) {
                calculator.displayValue = digit;
                calculator.waitingForSecondOperand = false;
            } else {
                calculator.displayValue = displayValue === '0' ? digit : displayValue + digit;
            }
            
            calculator.lastAction = 'digit';
        }

        // Input decimal
        function inputDecimal() {
            if (calculator.waitingForSecondOperand) {
                calculator.displayValue = '0.';
                calculator.waitingForSecondOperand = false;
                return;
            }
            
            if (!calculator.displayValue.includes('.')) {
                calculator.displayValue += '.';
            }
            
            calculator.lastAction = 'decimal';
        }

        // Handle operators
        function handleOperator(nextOperator) {
            const { firstOperand, displayValue, operator } = calculator;
            const inputValue = parseFloat(displayValue);
            
            if (operator && calculator.waitingForSecondOperand) {
                calculator.operator = nextOperator;
                return;
            }
            
            if (firstOperand === null) {
                calculator.firstOperand = inputValue;
            } else if (operator) {
                const result = performCalculation[operator](firstOperand, inputValue);
                
                if (result === 'Error') {
                    handleError();
                    return;
                }
                
                calculator.displayValue = `${parseFloat(result.toFixed(10))}`;
                calculator.firstOperand = result;
            }
            
            calculator.waitingForSecondOperand = true;
            calculator.operator = nextOperator;
            calculator.lastAction = 'operator';
        }

        // Perform calculations
        const performCalculation = {
            '/': (firstOperand, secondOperand) => {
                if (secondOperand === 0) {
                    return 'Error';
                }
                return firstOperand / secondOperand;
            },
            '*': (firstOperand, secondOperand) => firstOperand * secondOperand,
            '+': (firstOperand, secondOperand) => firstOperand + secondOperand,
            '-': (firstOperand, secondOperand) => firstOperand - secondOperand
        };

        // Reset calculator
        function resetCalculator() {
            calculator.displayValue = '0';
            calculator.firstOperand = null;
            calculator.waitingForSecondOperand = false;
            calculator.operator = null;
            calculator.lastAction = 'clear';
            errorIndicator.textContent = '';
        }

        // Handle equals
        function handleEquals() {
            const { firstOperand, displayValue, operator } = calculator;
            
            if (firstOperand === null || operator === null) {
                return;
            }
            
            const inputValue = parseFloat(displayValue);
            const result = performCalculation[operator](firstOperand, inputValue);
            
            if (result === 'Error') {
                handleError();
                return;
            }
            
            calculator.displayValue = `${parseFloat(result.toFixed(10))}`;
            calculator.firstOperand = null;
            calculator.waitingForSecondOperand = false;
            calculator.operator = null;
            calculator.lastAction = 'equals';
        }

        // Handle error
        function handleError() {
            calculator.displayValue = 'Error';
            calculator.firstOperand = null;
            calculator.waitingForSecondOperand = false;
            calculator.operator = null;
            calculator.lastAction = 'error';
            errorIndicator.textContent = 'MATH ERROR';
        }

        // Handle special functions
        function handleSpecialFunction(action) {
            const currentValue = parseFloat(calculator.displayValue);
            let result;
            
            switch (action) {
                case 'sqrt':
                    if (currentValue < 0) {
                        handleError();
                        return;
                    }
                    result = Math.sqrt(currentValue);
                    break;
                case 'square':
                    result = currentValue * currentValue;
                    break;
                case 'percent':
                    result = currentValue / 100;
                    break;
                case 'reciprocal':
                    if (currentValue === 0) {
                        handleError();
                        return;
                    }
                    result = 1 / currentValue;
                    break;
                case 'factorial':
                    if (currentValue < 0 || !Number.isInteger(currentValue)) {
                        handleError();
                        return;
                    }
                    result = factorial(currentValue);
                    break;
                case 'plus-minus':
                    result = -currentValue;
                    break;
                case 'pi':
                    result = Math.PI;
                    break;
                case 'log':
                    if (currentValue <= 0) {
                        handleError();
                        return;
                    }
                    result = Math.log10(currentValue);
                    break;
                case 'ln':
                    if (currentValue <= 0) {
                        handleError();
                        return;
                    }
                    result = Math.log(currentValue);
                    break;
                case 'exponent':
                    calculator.displayValue += 'E';
                    calculator.lastAction = 'exponent';
                    return;
                default:
                    return;
            }
            
            calculator.displayValue = `${parseFloat(result.toFixed(10))}`;
            calculator.lastAction = 'function';
        }

        // Factorial function
        function factorial(n) {
            if (n === 0 || n === 1) return 1;
            let result = 1;
            for (let i = 2; i <= n; i++) {
                result *= i;
            }
            return result;
        }

        // Handle memory functions
        function handleMemoryFunction(action) {
            const currentValue = parseFloat(calculator.displayValue);
            
            switch (action) {
                case 'mc':
                    calculator.memory = 0;
                    break;
                case 'mr':
                    calculator.displayValue = `${calculator.memory}`;
                    break;
                case 'm-plus':
                    calculator.memory += currentValue;
                    break;
                case 'm-minus':
                    calculator.memory -= currentValue;
                    break;
            }
            
            calculator.lastAction = 'memory';
            updateDisplay();
        }

        // Handle backspace
        function handleBackspace() {
            if (calculator.displayValue.length > 1) {
                calculator.displayValue = calculator.displayValue.slice(0, -1);
            } else {
                calculator.displayValue = '0';
            }
            calculator.lastAction = 'backspace';
        }

        // Button click handler
        function handleButtonClick(event) {
            const { target } = event;
            
            if (!target.classList.contains('button')) {
                return;
            }
            
            // Add visual feedback
            target.classList.add('active');
            setTimeout(() => {
                target.classList.remove('active');
            }, 150);
            
            // Handle different button types
            if (target.hasAttribute('data-number')) {
                inputDigit(target.getAttribute('data-number'));
            } else if (target.getAttribute('data-action') === 'decimal') {
                inputDecimal();
            } else if (target.getAttribute('data-action') === 'clear') {
                resetCalculator();
            } else if (target.getAttribute('data-action') === 'equals') {
                handleEquals();
            } else if (target.getAttribute('data-action') === 'backspace') {
                handleBackspace();
            } else if (['+', '-', '*', '/'].includes(target.textContent)) {
                handleOperator(target.textContent);
            } else if (target.classList.contains('function')) {
                const action = target.getAttribute('data-action');
                if (['mc', 'mr', 'm-plus', 'm-minus'].includes(action)) {
                    handleMemoryFunction(action);
                } else {
                    handleSpecialFunction(action);
                }
            }
            
            updateDisplay();
        }

        // Keyboard support
        function handleKeyboardInput(event) {
            const { key } = event;
            
            if (/[0-9]/.test(key)) {
                inputDigit(key);
            } else if (key === '.') {
                inputDecimal();
            } else if (key === 'Enter' || key === '=') {
                handleEquals();
            } else if (key === 'Escape' || key === 'Delete') {
                resetCalculator();
            } else if (key === 'Backspace') {
                handleBackspace();
            } else if (['+', '-', '*', '/'].includes(key)) {
                handleOperator(key);
            }
            
            updateDisplay();
        }

        // Initialize calculator
        function initCalculator() {
            // Add event listeners to buttons
            document.querySelector('.buttons-grid').addEventListener('click', handleButtonClick);
            
            // Add keyboard support
            document.addEventListener('keydown', handleKeyboardInput);
            
            // Initial display update
            updateDisplay();
        }

        // Initialize when page loads
        window.addEventListener('load', initCalculator);
    </script>
</body>
</html>